{% extends "./public/base.html" %}
{% load static %}

{% block main_content %}
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                Bangla News
                <small>Classifier</small>
            </h1>
            <ol class="breadcrumb">
                <li><a href="{% url 'home' %}"><i class="fa fa-dashboard"></i> Home</a></li>
                <li class="active">Bangla News Classifier</li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">
            <div class="row">
                <div class="col-md-7 col-xs-6">
                    <div class="row">
{#                        <div class="col-md-push-2 col-md-4 col-xs-6">#}
{#                            <label>Model</label>#}
{#                        </div>#}
{#                        <div class="col-md-8  col-xs-6">#}
{#                            <div class="form-group">#}
{#                                <select id="model" class="form-control">#}
{#                                    <option value="NB">Naive Bayes</option>#}
{#                                    <option value="SVM">SVM</option>#}
{#                                    <option value="MLP">MLP</option>#}
{#                                    <option value="CNN">CNN</option>#}
{#                                    <option value="LSTM">LSTM</option>#}
{#                                    <option value="OM">Our Model</option>#}
{#                                </select>#}
{#                            </div>#}
{#                        </div>#}
                    </div>
                    <div class="row">
                        <div class="col-md-push-2 col-md-4 col-xs-6">
                            <label>Data Set</label>
                        </div>
                        <div class="col-md-8  col-xs-6">
                            <div class="form-group">
                                <select id="dataSet" class="form-control">
                                    <option value="BanFakeNews">BanFakeNews</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-push-2 col-md-4 col-xs-6">
                            <label>News</label>
                        </div>
                        <div class="col-md-8  col-xs-6">
                            <textarea id="news" class="form-control" rows="25" placeholder="Enter ..."></textarea>
                        </div>
                    </div>
                    <div class="row" style="padding-top: 10px">
                        <div class="col-md-push-2 col-md-4 col-xs-6">
                            <label></label>
                        </div>
                        <div class="col-md-8  col-xs-6">
                            <button id="btn_submit" type="button" class="btn btn-block btn-primary" onClick="submit_news()">
                                Submit
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5 col-xs-6">
                    <div class="col-lg-12 col-xs-6">
                        <div class="box">
                            <div class="box-header">
                                <h3 class="box-title">Fake News Classifier</h3>
                            </div>
                            <!-- /.box-header -->
                            <div class="box-body no-padding">
                                <table class="table table-striped">
                                    <tr>
                                        <th style="width: 10px">#</th>
                                        <th>Model</th>
                                        <th>Result</th>
                                        <th>Time(s)</th>
                                        <th>Accuracy</th>
                                        <th>Confidence</th>
                                    </tr>
                                    <tr>
                                        <td id="tb_id1"></td>
                                        <td id="tb_model1"></td>
                                        <td id="tb_result1"></td>
                                        <td ><span id="tb_time1" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy1" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence1" class="badge bg-red"></span></td>
                                    </tr>

                                    <tr>
                                        <td id="tb_id2"></td>
                                        <td id="tb_model2"></td>
                                        <td id="tb_result2"></td>
                                        <td ><span id="tb_time2" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy2" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence2" class="badge bg-red"></span></td>
                                    </tr>

                                    <tr>
                                        <td id="tb_id3"></td>
                                        <td id="tb_model3"></td>
                                        <td id="tb_result3"></td>
                                        <td ><span id="tb_time3" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy3" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence3" class="badge bg-red"></span></td>
                                    </tr>

                                    <tr>
                                        <td id="tb_id4"></td>
                                        <td id="tb_model4"></td>
                                        <td id="tb_result4"></td>
                                        <td ><span id="tb_time4" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy4" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence4" class="badge bg-red"></span></td>
                                    </tr>

                                    <tr>
                                        <td id="tb_id5"></td>
                                        <td id="tb_model5"></td>
                                        <td id="tb_result5"></td>
                                        <td ><span id="tb_time5" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy5" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence5" class="badge bg-red"></span></td>
                                    </tr>

                                    <tr>
                                        <td id="tb_id6"></td>
                                        <td id="tb_model6"></td>
                                        <td id="tb_result6"></td>
                                        <td ><span id="tb_time6" class="badge bg-red"></span></td>
                                        <td ><span id="tb_accuracy6" class="badge bg-red"></span></td>
                                        <td ><span id="tb_confidence6" class="badge bg-red"></span></td>
                                    </tr>


                                </table>
                            </div>
                            <!-- /.box-body -->
                            <h5 id="consensus" style="text-align:center"></h5>
                        </div>

                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label id="resultLabel"></label>
                </div>
            </div>


        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    {% block script %}
        <script type="text/javascript">
            function submit_news() {
                $('#btn_submit').attr("disabled", true);
                {#var model = $('#model').val();#}
                var dataset = $('#dataSet').val();
                var news = $('#news').val();
                var param = {
                    {#'model': model,#}
                    'dataset': dataset,
                    'news': news
                };
                {#alert(param);#}
                $.ajax({
                    url: "{% url 'classifier' %}",
                    data: param,
                    type: 'GET',
                    success: function (data) {

                            for(i=1;i<=6;i++){
                                $('#tb_id'+i).empty();
                                $('#tb_model'+i).empty();
                                $('#tb_result'+i).empty();
                                $('#tb_time'+i).empty();
                                $('#tb_accuracy'+i).empty();
                                $('#tb_confidence'+i).empty();
                            }
                            $('#consensus').empty();

                            if(data.length==0){
                                $('#consensus').text("Some error has occurred. Please try again or try using some different data.");
                            }
                            else{
                                count=0
                                console.log(data)
                                for(i=1;i<=6;i++){
                                    res = data[i-1]
                                    $('#tb_id'+i).text(i);
                                    $('#tb_model'+i).text(res.model);
                                    $('#tb_result'+i).text(res.result);
                                    $('#tb_time'+i).text(res.time);
                                    $('#tb_accuracy'+i).text(res.accuracy);
                                    $('#tb_confidence'+i).text(res.confidence);

                                    if(res.result=="FAKE"){count-=1;}
                                    else {count+=1;}
                                }
                                if(count>=0)$('#consensus').text("The consensus is REAL!");
                                else {$('#consensus').text("The consensus is FAKE!");}
                            }
                            $('#btn_submit').attr("disabled", false);


                    }
                });
            }
        </script>

    {% endblock %}

{% endblock %}